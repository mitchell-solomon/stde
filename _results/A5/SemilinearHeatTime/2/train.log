Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
Args:
{ 'N_test': 20000,
  'SEED': 2,
  'activation': 'tanh',
  'ad_mode': 'forward',
  'backbone': 'Mamba',
  'bidirectional': False,
  'complement': False,
  'custom_vjp_scan': False,
  'dense_expansion': 2,
  'diag_gate': False,
  'diag_gated': False,
  'diag_residual': False,
  'diag_skip': False,
  'dt_rank': 'auto',
  'epochs': 10000,
  'eqn_name': 'SemilinearHeatTime',
  'eval_every': 50000000,
  'expansion_factor': 2.0,
  'gamma': 0.9995,
  'hess_diag_method': 'forward',
  'hidden_features': 64,
  'lr': 0.0001,
  'lr_decay': 'linear',
  'min_recursion_length': 100,
  'n_fgd_vec': 0,
  'no_stde': True,
  'norm_type': 'none',
  'num_mamba_blocks': 1,
  'optimizer': 'adam',
  'rand_batch_size': 1,
  'recursive_scan': False,
  'recursive_split': False,
  'run_name': 'A5/SemilinearHeatTime/2',
  'sampling_mode': 'random',
  'save_every': 10000,
  'seed_frac': 0.01,
  'seq_len': 5,
  'spatial_dim': 10,
  'ssm_activation': 'silu',
  'stde_dist': 'rademacher',
  'test_batch_size': 5,
  'tie_gate': False,
  'tie_in_proj': False,
  'use_seed_seq': True,
  'x_ordering': 'radial',
  'x_radius': 1.0}

Instantiating model with backbone Mamba
Model instantiated
Input shape: (2, 5, 11)
Output shape: (2, 5)
Model architecture:
                                                              PINN Summary                                                              
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ path                                           ┃ module             ┃ inputs            ┃ outputs          ┃ params                  ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│                                                │ PINN               │ float32[4,5,11]   │ float32[4,5]     │                         │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0                           │ BidirectionalMamba │ float32[4,5,11]   │ float32[4,5,11]  │                         │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/in_proj                   │ Dense              │ float32[4,5,11]   │ float32[4,5,88]  │ bias: float32[88]       │
│                                                │                    │                   │                  │ kernel: float32[11,88]  │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 1,056 (4.2 KB)          │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/SelectiveSSM_0            │ SelectiveSSM       │ - float32[4,5,22] │ float32[4,5,22]  │ A_log: float32[22,64]   │
│                                                │                    │ - False           │                  │ D: float32[22]          │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 1,430 (5.7 KB)          │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/SelectiveSSM_0/shift_conv │ Conv               │ float32[4,5,22]   │ float32[4,5,22]  │ kernel: float32[3,1,22] │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 66 (264 B)              │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/SelectiveSSM_0/BC         │ Dense              │ float32[4,5,22]   │ float32[4,5,128] │ bias: float32[128]      │
│                                                │                    │                   │                  │ kernel: float32[22,128] │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 2,944 (11.8 KB)         │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/SelectiveSSM_0/dt         │ Dense              │ float32[4,5,22]   │ float32[4,5,1]   │ bias: float32[1]        │
│                                                │                    │                   │                  │ kernel: float32[22,1]   │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 23 (92 B)               │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/SelectiveSSM_0/dt_proj    │ Dense              │ float32[4,5,1]    │ float32[4,5,22]  │ bias: float32[22]       │
│                                                │                    │                   │                  │ kernel: float32[1,22]   │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 44 (176 B)              │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ BidirectionalMamba_0/out_proj                  │ Dense              │ float32[4,5,22]   │ float32[4,5,11]  │ bias: float32[11]       │
│                                                │                    │                   │                  │ kernel: float32[22,11]  │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 253 (1.0 KB)            │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ mlp                                            │ Dense              │ float32[4,5,11]   │ float32[4,5,22]  │ bias: float32[22]       │
│                                                │                    │                   │                  │ kernel: float32[11,22]  │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 264 (1.1 KB)            │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│ mlp_proj                                       │ Dense              │ float32[4,5,22]   │ float32[4,5,1]   │ bias: float32[1]        │
│                                                │                    │                   │                  │ kernel: float32[22,1]   │
│                                                │                    │                   │                  │                         │
│                                                │                    │                   │                  │ 23 (92 B)               │
├────────────────────────────────────────────────┼────────────────────┼───────────────────┼──────────────────┼─────────────────────────┤
│                                                │                    │                   │            Total │ 6,103 (24.4 KB)         │
└────────────────────────────────────────────────┴────────────────────┴───────────────────┴──────────────────┴─────────────────────────┘
                                                                                                                                        
                                                   Total Parameters: 6,103 (24.4 KB)                                                    


num params: 6103
iter=0 | l1_rel=nan | l2_rel=nan | loss=nan | grad_norm=nan
iter=9999 | l1_rel=nan | l2_rel=nan | loss=nan | grad_norm=nan
Final → l1_rel=nan
