Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
Args:
{ 'N_test': 20000,
  'SEED': 0,
  'activation': 'tanh',
  'ad_mode': 'reverse',
  'backbone': 'MLP',
  'bidirectional': False,
  'complement': False,
  'custom_vjp_scan': False,
  'dense_expansion': 2,
  'diag_gate': False,
  'diag_gated': False,
  'diag_residual': False,
  'diag_skip': False,
  'dt_rank': 'auto',
  'epochs': 10000,
  'eqn_name': 'Wave',
  'eval_every': 50000000,
  'expansion_factor': 2.0,
  'gamma': 0.9995,
  'hess_diag_method': 'sparse_stde',
  'hidden_features': 64,
  'lr': 0.0001,
  'lr_decay': 'linear',
  'min_recursion_length': 100,
  'n_fgd_vec': 0,
  'no_stde': False,
  'norm_type': 'none',
  'num_mamba_blocks': 1,
  'optimizer': 'adam',
  'rand_batch_size': 1,
  'recursive_scan': False,
  'recursive_split': False,
  'run_name': 'A4/Wave/0',
  'sampling_mode': 'random',
  'save_every': 10000,
  'seed_frac': 0.01,
  'seq_len': 5,
  'spatial_dim': 1,
  'ssm_activation': 'silu',
  'stde_dist': 'rademacher',
  'test_batch_size': 20,
  'tie_gate': False,
  'tie_in_proj': False,
  'use_seed_seq': True,
  'x_ordering': 'radial',
  'x_radius': 1.0}

Input shape: (2, 5, 2)
Output shape: (2, 5)
Model architecture:
                                       BiMambaPINN Summary                                       
┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┓
┃ path                    ┃ module      ┃ inputs         ┃ outputs       ┃ params               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━┩
│                         │ BiMambaPINN │ float64[4,5,2] │ float64[4,5]  │                      │
├─────────────────────────┼─────────────┼────────────────┼───────────────┼──────────────────────┤
│ MlpBackbone_0           │ MlpBackbone │ float64[4,5,2] │ float64[4,5]  │                      │
├─────────────────────────┼─────────────┼────────────────┼───────────────┼──────────────────────┤
│ MlpBackbone_0/dense_out │ Dense       │ float64[20,2]  │ float64[20,1] │ bias: float32[1]     │
│                         │             │                │               │ kernel: float32[2,1] │
│                         │             │                │               │                      │
│                         │             │                │               │ 3 (12 B)             │
├─────────────────────────┼─────────────┼────────────────┼───────────────┼──────────────────────┤
│                         │             │                │         Total │ 3 (12 B)             │
└─────────────────────────┴─────────────┴────────────────┴───────────────┴──────────────────────┘
                                                                                                 
                                   Total Parameters: 3 (12 B)                                    


num params: 3
iter=0 | l1_rel=1.78e-01 | l2_rel=2.38e-01 | loss=6.61e+00 | grad_norm=2.82e+01
iter=9999 | l1_rel=8.26e-02 | l2_rel=1.13e-01 | loss=1.89e+00 | grad_norm=2.64e+01
Final → l1_rel=8.301e-02 | l2_rel=1.136e-01
